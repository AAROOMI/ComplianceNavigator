<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Metaworks Cybersecurity Compliance Platform</title>
    <meta name="description" content="NCA ECC V1 & V2 Compliance Management with AI-powered assistance" />
    <!-- Sarah Johnson D-ID Agent - Direct Link Method -->
    <script>
      // Sarah Johnson AI Assistant Integration
      
      // Initialize Sarah Johnson AI Assistant
      document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 Sarah Johnson AI Assistant ready');
        
        // Global function to launch Sarah Johnson D-ID agent
        window.openDIDAgent = function() {
          console.log('🎤 Sarah Johnson clicked - opening D-ID voice agent...');
          
          // D-ID Agent Share URL with clean interface
          const didAgentURL = 'https://studio.d-id.com/agents/share?id=v2_agt_D0t5wjZD&utm_source=copy&key=WVhWMGFEQjhOamRsWldJM05tWXdPVFl4WkRVMFlqZzJOMlk0WldFM09rTXdjRXhxZUhwRFlrbDBWV3QwTjFkQlEwNTZXUT09&hide_branding=true&minimal=true';
          
          // Show D-ID agent in modal overlay
          const existingModal = document.getElementById('sarah-did-modal');
          if (existingModal) {
            existingModal.remove();
          }
          
          const modal = document.createElement('div');
          modal.id = 'sarah-did-modal';
          modal.innerHTML = `
            <div style="
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.8) 0%, 
                rgba(118, 75, 162, 0.8) 25%,
                rgba(255, 255, 255, 0.1) 50%,
                rgba(102, 126, 234, 0.6) 75%,
                rgba(118, 75, 162, 0.9) 100%);
              backdrop-filter: blur(20px);
              -webkit-backdrop-filter: blur(20px);
              z-index: 10000;
              display: flex;
              align-items: center;
              justify-content: center;
              animation: fadeIn 0.3s ease-out;
            ">
              <div style="
                width: 500px;
                height: 650px;
                background: linear-gradient(145deg, 
                  rgba(255, 255, 255, 0.25) 0%,
                  rgba(255, 255, 255, 0.1) 50%,
                  rgba(255, 255, 255, 0.05) 100%);
                backdrop-filter: blur(30px);
                -webkit-backdrop-filter: blur(30px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 25px;
                position: relative;
                overflow: hidden;
                box-shadow: 
                  0 25px 50px rgba(0, 0, 0, 0.25),
                  0 0 0 1px rgba(255, 255, 255, 0.1),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2);
                transition: all 0.3s ease;
              ">
                <!-- Glass morphism header -->
                <div style="
                  position: absolute;
                  top: 0;
                  left: 0;
                  right: 0;
                  height: 60px;
                  background: linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.2) 0%,
                    rgba(255, 255, 255, 0.1) 100%);
                  backdrop-filter: blur(10px);
                  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                  display: flex;
                  align-items: center;
                  justify-content: space-between;
                  padding: 0 20px;
                  z-index: 10001;
                ">
                  <div style="
                    color: white;
                    font-weight: 600;
                    font-size: 18px;
                    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
                  ">Sarah Johnson • AI Assistant</div>
                  <button onclick="document.getElementById('sarah-did-modal').remove()" style="
                    background: rgba(255, 255, 255, 0.2);
                    color: white;
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    width: 35px;
                    height: 35px;
                    border-radius: 50%;
                    cursor: pointer;
                    font-size: 18px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    backdrop-filter: blur(10px);
                    transition: all 0.2s ease;
                  " onmouseover="
                    this.style.background='rgba(255, 255, 255, 0.3)';
                    this.style.transform='scale(1.1)';
                  " onmouseout="
                    this.style.background='rgba(255, 255, 255, 0.2)';
                    this.style.transform='scale(1)';
                  ">×</button>
                </div>
                
                <!-- Sarah frame container -->
                <div style="
                  position: absolute;
                  top: 60px;
                  left: 0;
                  right: 0;
                  bottom: 0;
                  border-radius: 0 0 25px 25px;
                  overflow: hidden;
                  background: linear-gradient(145deg, 
                    rgba(255, 255, 255, 0.1) 0%,
                    rgba(255, 255, 255, 0.05) 100%);
                ">
                  <iframe 
                    src="${didAgentURL}"
                    style="
                      width: 100%;
                      height: 100%;
                      border: none;
                      border-radius: 0 0 25px 25px;
                      background: transparent;
                    "
                    allow="microphone; camera"
                    title="Sarah Johnson - AI Voice Assistant"
                    onload="
                      try {
                        const iframe = this;
                        setTimeout(() => {
                          try {
                            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                            const style = iframeDoc.createElement('style');
                            style.textContent = \`
                              /* Hide ALL D-ID UI except Sarah's frame */
                              body { 
                                background: transparent !important; 
                                overflow: hidden !important;
                              }
                              
                              /* Hide everything except the main video/avatar area */
                              header, .header, [class*='header'] { display: none !important; }
                              footer, .footer, [class*='footer'] { display: none !important; }
                              nav, .nav, [class*='nav'] { display: none !important; }
                              [class*='brand'], [class*='Brand'], [class*='logo'], [class*='Logo'] { display: none !important; }
                              [class*='share'], [class*='Share'] { display: none !important; }
                              [class*='create'], [class*='Create'] { display: none !important; }
                              [class*='build'], [class*='Build'] { display: none !important; }
                              [class*='powered'], [class*='Powered'] { display: none !important; }
                              [class*='watermark'], [id*='watermark'] { display: none !important; }
                              [class*='sidebar'], [class*='menu'] { display: none !important; }
                              [data-testid*='share'], [data-testid*='create'], [data-testid*='build'] { display: none !important; }
                              
                              /* Hide all buttons except start conversation */
                              button:not([class*='start']):not([class*='conversation']):not([class*='talk']):not([class*='speak']) { 
                                display: none !important; 
                              }
                              
                              /* Focus only on the main content area */
                              [class*='main'], [class*='content'], [class*='video'], [class*='avatar'] {
                                width: 100% !important;
                                height: 100% !important;
                                max-width: none !important;
                                max-height: none !important;
                                border-radius: 0 0 25px 25px !important;
                              }
                              
                              /* Clean background for Sarah's frame */
                              * {
                                background-color: transparent !important;
                                border: none !important;
                              }
                              
                              /* Keep only essential conversation elements visible */
                              [class*='conversation'], [class*='start'], [class*='talk'], [class*='speak'] {
                                display: block !important;
                              }
                            \`;
                            iframeDoc.head.appendChild(style);
                            console.log('✅ D-ID interface cleaned - focusing on Sarah only');
                          } catch (e) {
                            console.warn('⚠️ Could not access iframe content (CORS):', e.message);
                          }
                        }, 2000);
                      } catch (e) {
                        console.warn('⚠️ Iframe onload error:', e.message);
                      }
                    "
                  ></iframe>
                </div>
              </div>
            </div>
            
            <style>
              @keyframes fadeIn {
                from { opacity: 0; transform: scale(0.9); }
                to { opacity: 1; transform: scale(1); }
              }
              
              #sarah-did-modal {
                animation: fadeIn 0.3s ease-out;
              }
              
              #sarah-did-modal > div > div:hover {
                transform: translateY(-5px);
                box-shadow: 
                  0 35px 70px rgba(0, 0, 0, 0.3),
                  0 0 0 1px rgba(255, 255, 255, 0.2),
                  inset 0 1px 0 rgba(255, 255, 255, 0.3);
              }
            </style>
          `;
          
          document.body.appendChild(modal);
          console.log('✅ D-ID Voice Agent opened successfully!');
          
          return true;
        };
        
        // Sarah Johnson voice agent ready
        console.log('✅ Sarah Johnson voice agent ready - click her picture to start conversation');
        
        // Placeholder function (not used)
        function showFallbackChat() {
          console.log('🎯 Opening Sarah Johnson chat interface...');
          
          // Remove existing chat if present
          const existingChat = document.getElementById('sarah-chat-widget');
          if (existingChat) {
            console.log('🗑️ Removing existing chat widget');
            existingChat.remove();
          }
          
          // Sarah Johnson chat is now active
          
          // Create chat widget
          const chatWidget = document.createElement('div');
          chatWidget.id = 'sarah-chat-widget';
          chatWidget.innerHTML = `
            <div style="
              position: fixed;
              bottom: 20px;
              right: 20px;
              width: 350px;
              height: 500px;
              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
              border-radius: 15px;
              box-shadow: 0 10px 30px rgba(0,0,0,0.3);
              z-index: 10000;
              display: flex;
              flex-direction: column;
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            ">
              <!-- Header -->
              <div style="
                background: rgba(255,255,255,0.1);
                padding: 15px;
                border-radius: 15px 15px 0 0;
                display: flex;
                align-items: center;
                justify-content: space-between;
                backdrop-filter: blur(10px);
              ">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <div style="
                    width: 40px;
                    height: 40px;
                    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><circle cx="12" cy="8" r="3"/><path d="M12 14c-4 0-8 2-8 6v2h16v-2c0-4-4-6-8-6z"/></svg>') center/cover;
                    border-radius: 50%;
                    border: 2px solid rgba(255,255,255,0.3);
                  "></div>
                  <div>
                    <div style="color: white; font-weight: 600; font-size: 16px;">Sarah Johnson</div>
                    <div style="color: rgba(255,255,255,0.8); font-size: 12px;">CEO • Cybersecurity Expert</div>
                  </div>
                </div>
                <button onclick="document.getElementById('sarah-chat-widget').remove()" style="
                  background: none;
                  border: none;
                  color: white;
                  font-size: 20px;
                  cursor: pointer;
                  padding: 5px;
                  border-radius: 5px;
                  opacity: 0.7;
                " onmouseover="this.style.opacity='1'; this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.opacity='0.7'; this.style.background='none'">×</button>
              </div>
              
              <!-- Chat Messages -->
              <div id="sarah-chat-messages" style="
                flex: 1;
                padding: 20px;
                overflow-y: auto;
                background: rgba(255,255,255,0.05);
              ">
                <div style="
                  background: rgba(255,255,255,0.9);
                  padding: 12px 16px;
                  border-radius: 15px 15px 15px 5px;
                  margin-bottom: 15px;
                  color: #333;
                  font-size: 14px;
                  line-height: 1.4;
                ">
                  <div style="font-weight: 600; color: #667eea; margin-bottom: 5px;">Sarah Johnson</div>
                  👋 Hello! I'm Sarah Johnson, CEO of ComplianceNavigator. I'm here to help you with cybersecurity compliance, risk assessments, and NCA ECC implementation.
                </div>
                <div style="
                  background: rgba(255,255,255,0.9);
                  padding: 12px 16px;
                  border-radius: 15px 15px 15px 5px;
                  margin-bottom: 15px;
                  color: #333;
                  font-size: 14px;
                  line-height: 1.4;
                ">
                  <div style="font-weight: 600; color: #667eea; margin-bottom: 5px;">Sarah Johnson</div>
                  What can I help you with today? You can ask me about:
                  <ul style="margin: 8px 0 0 0; padding-left: 20px;">
                    <li>Risk assessment strategies</li>
                    <li>NCA ECC compliance requirements</li>
                    <li>Implementation best practices</li>
                    <li>Security policy development</li>
                  </ul>
                </div>
              </div>
              
              <!-- Input -->
              <div style="
                padding: 15px;
                background: rgba(255,255,255,0.1);
                border-radius: 0 0 15px 15px;
                backdrop-filter: blur(10px);
              ">
                <div style="display: flex; gap: 10px;">
                  <input 
                    id="sarah-chat-input" 
                    type="text" 
                    placeholder="Ask Sarah about cybersecurity..." 
                    style="
                      flex: 1;
                      padding: 10px 15px;
                      border: none;
                      border-radius: 25px;
                      background: rgba(255,255,255,0.9);
                      outline: none;
                      font-size: 14px;
                    "
                    onkeypress="if(event.key==='Enter') sendSarahMessage()"
                  >
                  <button 
                    onclick="sendSarahMessage()" 
                    style="
                      background: linear-gradient(45deg, #667eea, #764ba2);
                      border: none;
                      color: white;
                      width: 40px;
                      height: 40px;
                      border-radius: 50%;
                      cursor: pointer;
                      font-size: 16px;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                    "
                    onmouseover="this.style.transform='scale(1.1)'" 
                    onmouseout="this.style.transform='scale(1)'"
                  >→</button>
                </div>
              </div>
            </div>
          `;
          
          document.body.appendChild(chatWidget);
          
          // Focus input
          setTimeout(() => {
            const input = document.getElementById('sarah-chat-input');
            if (input) input.focus();
          }, 100);
          
          console.log('✅ Sarah Johnson chat is now ready!');
          
          // Add a subtle animation
          setTimeout(() => {
            chatWidget.style.transform = 'scale(1.02)';
            setTimeout(() => {
              chatWidget.style.transform = 'scale(1)';
              chatWidget.style.transition = 'transform 0.2s ease';
            }, 150);
          }, 100);
        }
        
        // Handle chat messages
        window.sendSarahMessage = function() {
          const input = document.getElementById('sarah-chat-input');
          const messages = document.getElementById('sarah-chat-messages');
          
          if (!input || !messages || !input.value.trim()) return;
          
          const userMessage = input.value.trim();
          input.value = '';
          
          // Add user message
          const userDiv = document.createElement('div');
          userDiv.style.cssText = `
            background: linear-gradient(45deg, #667eea, #764ba2);
            padding: 12px 16px;
            border-radius: 15px 15px 5px 15px;
            margin: 15px 0;
            margin-left: 50px;
            color: white;
            font-size: 14px;
            line-height: 1.4;
          `;
          userDiv.innerHTML = `<div style="font-weight: 600; margin-bottom: 5px; opacity: 0.8;">You</div>${userMessage}`;
          messages.appendChild(userDiv);
          
          // Simulate Sarah's response
          setTimeout(() => {
            const responses = [
              "That's a great question about cybersecurity compliance. Based on the NCA ECC framework, I recommend starting with a comprehensive risk assessment to identify your current security posture.",
              "For NCA ECC implementation, focus on the five core domains: Governance, Cybersecurity Defence, Cybersecurity Resilience, Third Party Cloud Computing, and Industrial Control Systems.",
              "Risk management is crucial for compliance. I suggest using our NFRM Risk Management tool to conduct thorough assessments and generate detailed reports.",
              "Security policies should align with your organizational structure. Our AI-powered policy generator can help you create customized policies based on NCA ECC requirements.",
              "Gap assessments are essential for identifying compliance gaps. Use our ECC Implementation Dashboard to track your progress across all 114 essential controls.",
              "Remember that cybersecurity compliance is an ongoing process. Regular assessments, continuous monitoring, and staff training are key components of a successful program."
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            
            const sarahDiv = document.createElement('div');
            sarahDiv.style.cssText = `
              background: rgba(255,255,255,0.9);
              padding: 12px 16px;
              border-radius: 15px 15px 15px 5px;
              margin: 15px 0;
              color: #333;
              font-size: 14px;
              line-height: 1.4;
            `;
            sarahDiv.innerHTML = `<div style="font-weight: 600; color: #667eea; margin-bottom: 5px;">Sarah Johnson</div>${randomResponse}`;
            messages.appendChild(sarahDiv);
            
            // Scroll to bottom
            messages.scrollTop = messages.scrollHeight;
          }, 1000);
          
          // Scroll to bottom
          messages.scrollTop = messages.scrollHeight;
        };
      });
    </script>
  </head>
  <body>
    <div id="root"></div>
    
    <!-- Sarah Johnson D-ID Voice Agent will open in modal when clicked -->
    
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>